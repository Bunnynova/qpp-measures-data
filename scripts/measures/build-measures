#!/usr/bin/env bash

# 1. Add QCDR measures to measures-data.json
echo "Adding QCDR measures to measures-data.json"
node ./scripts/import-csv-script.js | jq -s add $1 <(cat measures/measures-data.json) | tee measures/measures-data.json

# 2. Regenerate the `measures-data.xml` file:
echo "generating measures-data.xml from measures-data.json"
cat measures/measures-data.json | node scripts/convert-json-to-xml.js > measures/measures-data.xml

# 3. Validate the resulting measures-data.json file:
echo "validating new measures-data.json"
cat measures/measures-data.json | node scripts/validate-data.js measures
